{
  "version": 3,
  "sources": ["../../@tdesign/uniapp/dist/common/wechat.js", "../../@tdesign/uniapp/dist/common/utils.js"],
  "sourcesContent": ["export const getObserver = (context, selector) => new Promise((resolve) => {\n  uni\n    .createIntersectionObserver(context, {\n      nativeMode: true,\n    })\n    .relativeToViewport()\n    .observe(selector, (res) => {\n      resolve(res);\n    });\n});\n\n/**\n * 背景：单页模式下, getWindowInfo、getAppBaseInfo、getDeviceInfo 等接口均返回 undefined。\n * 复现路径：分享到朋友圈，再打开单页模式的该页面，uni.getWindowInfo() 等接口返回 undefined\n * 代码片段：https://developers.weixin.qq.com/s/mzvZ8FmH7vVW\n */\n\nexport const getWindowInfo = () => (uni.getWindowInfo ? uni.getWindowInfo() || uni.getSystemInfoSync() : uni.getSystemInfoSync());\n\nexport const getAppBaseInfo = () => (uni.getAppBaseInfo ? uni.getAppBaseInfo() || uni.getSystemInfoSync() : uni.getSystemInfoSync());\n\nexport const getDeviceInfo = () => (uni.getDeviceInfo ? uni.getDeviceInfo() || uni.getSystemInfoSync() : uni.getSystemInfoSync());\n", "import { prefix } from './config';\nimport { isString, isNumeric, isDef, isBoolean, isObject } from './validator';\nimport { getWindowInfo, getAppBaseInfo, getDeviceInfo } from './wechat';\n\nexport { getWindowInfo };\n\nexport const systemInfo = getWindowInfo();\n\nexport const appBaseInfo = getAppBaseInfo();\n\nexport const deviceInfo = getDeviceInfo();\n\n\n/**\n * 多参数空值合并函数\n * @param {...any} args - 任意数量的参数\n * @returns {any} 第一个非null/undefined的参数值\n */\nexport function coalesce(...args) {\n  // 遍历所有参数\n  for (let i = 0; i < args.length; i += 1) {\n    // 返回第一个非null且非undefined的值\n    if (args[i] !== null && args[i] !== undefined) {\n      return args[i];\n    }\n  }\n  // 如果所有参数都是null/undefined，返回最后一个参数\n  return args[args.length - 1];\n}\n\n\nexport const debounce = function (func, wait = 500) {\n  let timerId;\n  return function (...rest) {\n    if (timerId) {\n      clearTimeout(timerId);\n    }\n    timerId = setTimeout(() => {\n      func.apply(this, rest);\n    }, wait);\n  };\n};\n\nexport const throttle = (func, wait = 100, options = null) => {\n  let previous = 0;\n  let timerid = null;\n\n  if (!options) {\n    options = {\n      leading: true,\n    };\n  }\n\n  return function (...args) {\n    const now = Date.now();\n\n    if (!previous && !options.leading) previous = now;\n\n    const remaining = wait - (now - previous);\n    const context = this;\n\n    if (remaining <= 0) {\n      if (timerid) {\n        clearTimeout(timerid);\n        timerid = null;\n      }\n      previous = now;\n      func.apply(context, args);\n    }\n  };\n};\n\nexport const classNames = function (...args) {\n  const hasOwn = {}.hasOwnProperty;\n  const classes = [];\n\n  args.forEach((arg) => {\n    // for (let i = 0; i < args.length; i++) {\n    // eslint-disable-next-line\n    // const arg = args[i]\n    if (!arg) return;\n\n    const argType = typeof arg;\n\n    if (argType === 'string' || argType === 'number') {\n      classes.push(arg);\n    } else if (Array.isArray(arg) && arg.length) {\n      const inner = classNames(...arg);\n      if (inner) {\n        classes.push(inner);\n      }\n    } else if (argType === 'object') {\n      // eslint-disable-next-line\n      for (const key in arg) {\n        if (hasOwn.call(arg, key) && arg[key]) {\n          classes.push(key);\n        }\n      }\n    }\n  });\n\n  return classes.join(' ');\n};\n\nexport const styles = function (styleObj) {\n  return Object.keys(styleObj)\n    .map(styleKey => `${styleKey}: ${styleObj[styleKey]}`)\n    .join('; ');\n};\n\nexport const getAnimationFrame = function (context, cb) {\n  return uni\n    .createSelectorQuery()\n    .in(context)\n    .selectViewport()\n    .boundingClientRect()\n    .exec(() => {\n      cb();\n    });\n};\n\nexport const getRect = function (context, selector, needAll = false, useH5Origin = false) {\n  let result;\n\n  if (useH5Origin) {\n    result = document[needAll ? 'querySelectorAll' : 'querySelector'](selector)?.getBoundingClientRect();\n  }\n\n  if (result) {\n    return result;\n  }\n\n  return new Promise((resolve, reject) => {\n    uni\n      .createSelectorQuery()\n      .in(context)\n      // eslint-disable-next-line no-unexpected-multiline\n      [needAll ? 'selectAll' : 'select'](selector)\n      .boundingClientRect((rect) => {\n        if (rect) {\n          resolve(rect);\n        } else {\n          reject(rect);\n        }\n      })\n      .exec();\n  });\n};\n\n\nexport const getTreeDepth = (tree, key) => tree.reduce((maxDepth, node) => {\n  const keyName = coalesce(key, 'children');\n  if (node[keyName] && node[keyName].length > 0) {\n    return Math.max(maxDepth, getTreeDepth(node[keyName], key) + 1);\n  }\n  return Math.max(maxDepth, 1);\n}, 0);\n\nexport const isIOS = function () {\n  return !!(deviceInfo?.system?.toLowerCase().search('ios') + 1);\n};\n\n/**\n * 判断是否是为企微环境\n * 企微环境 wx.getSystemInfoSync() 接口会额外返回 environment 字段（微信中不返回）\n * https://developer.work.weixin.qq.com/document/path/91511\n */\nexport const isWxWork = deviceInfo?.environment === 'wxwork';\n\nexport const isPC = ['mac', 'windows'].includes(deviceInfo?.platform);\n\nexport const addUnit = function (value) {\n  if (!isDef(value)) {\n    return undefined;\n  }\n  value = String(value);\n  return isNumeric(value) ? `${value}px` : value;\n};\n\n/**\n * 计算字符串字符的长度并可以截取字符串。\n * @param char 传入字符串（maxcharacter条件下，一个汉字表示两个字符）\n * @param max 规定最大字符串长度\n * @returns 当没有传入maxCharacter/maxLength 时返回字符串字符长度，当传入maxCharacter/maxLength时返回截取之后的字符串和长度。\n */\nexport const getCharacterLength = (type, char, max) => {\n  const str = String(coalesce(char, ''));\n\n  if (str.length === 0) {\n    return {\n      length: 0,\n      characters: '',\n    };\n  }\n\n  if (type === 'maxcharacter') {\n    let len = 0;\n    for (let i = 0; i < str.length; i += 1) {\n      let currentStringLength = 0;\n      if (str.charCodeAt(i) > 127 || str.charCodeAt(i) === 94) {\n        currentStringLength = 2;\n      } else {\n        currentStringLength = 1;\n      }\n      if (len + currentStringLength > max) {\n        return {\n          length: len,\n          characters: str.slice(0, i),\n        };\n      }\n      len += currentStringLength;\n    }\n    return {\n      length: len,\n      characters: str,\n    };\n  }\n\n  if (type === 'maxlength') {\n    const length = str.length > max ? max : str.length;\n    return {\n      length,\n      characters: str.slice(0, length),\n    };\n  }\n\n  return {\n    length: str.length,\n    characters: str,\n  };\n};\n\nexport const chunk = (arr, size) => Array.from({ length: Math.ceil(arr.length / size) }, (v, i) => arr.slice(i * size, i * size + size));\n\n\nconst getPageContext = () => {\n  const pages = getCurrentPages();\n  const page = pages[pages.length - 1];\n  return (page).$$basePage || page;\n};\n\n\nconst findInstance = (context, pageContext, pureSelector) => {\n  if (context && context.$refs[pureSelector]) {\n    return context.$refs[pureSelector];\n  }\n  if (pageContext && pageContext.$refs[pureSelector]) {\n    return pageContext.$refs[pureSelector];\n  }\n  return null;\n};\n\nexport const getInstance = function (context, selector) {\n  const pageContext = getPageContext();\n  const pureSelector = /^[.#]/.test(selector) ? selector.slice(1) : selector;\n  const instance = findInstance(context, pageContext, pureSelector);\n\n  if (!instance) {\n    console.warn('未找到组件,请检查 selector 是否正确');\n    return null;\n  }\n  return instance;\n};\n\nexport const unitConvert = (value) => {\n  if (typeof value === 'string') {\n    if (value.includes('rpx')) {\n      return (parseInt(value, 10) * (coalesce(systemInfo?.screenWidth, 750))) / 750;\n    }\n    return parseInt(value, 10);\n  }\n  return coalesce(value, 0);\n};\n\nexport const setIcon = (iconName, icon, defaultIcon) => {\n  if (icon) {\n    if (typeof icon === 'string') {\n      return {\n        [`${iconName}Name`]: icon,\n        [`${iconName}Data`]: {},\n      };\n    }\n    if (typeof icon === 'object') {\n      return {\n        [`${iconName}Name`]: '',\n        [`${iconName}Data`]: icon,\n      };\n    }\n    return {\n      [`${iconName}Name`]: defaultIcon,\n      [`${iconName}Data`]: {},\n    };\n  }\n  return {\n    [`${iconName}Name`]: '',\n    [`${iconName}Data`]: {},\n  };\n};\n\nexport const toCamel = str => str.replace(/-(\\w)/g, (match, m1) => m1.toUpperCase());\nexport const toPascal = name => name\n  .split('-')\n  .map(part => part.charAt(0).toUpperCase() + part.slice(1))\n  .join('');\n\nexport function hyphenate(str) {\n  const hyphenateRE = /\\B([A-Z])/g;\n  return str.replace(hyphenateRE, '-$1').toLowerCase();\n}\nexport const getCurrentPage = function () {\n  const pages = getCurrentPages();\n  return pages[pages.length - 1];\n};\n\nexport const uniqueFactory = (compName) => {\n  let number = 0;\n  return () => {\n    const uniqueId = `${prefix}_${compName}_${number}`;\n    number += 1;\n    return uniqueId;\n  };\n};\n\nexport const calcIcon = (icon, defaultIcon) => {\n  if (icon && ((isBoolean(icon) && defaultIcon) || isString(icon))) {\n    return { name: isBoolean(icon) ? defaultIcon : icon };\n  }\n  if (isObject(icon)) {\n    return icon;\n  }\n  return null;\n};\n\nexport const isOverSize = (size, sizeLimit) => {\n  if (!sizeLimit) return false;\n\n  const base = 1000;\n  const unitMap = {\n    B: 1,\n    KB: base,\n    MB: base * base,\n    GB: base * base * base,\n  };\n  const computedSize = typeof sizeLimit === 'number'\n    ? sizeLimit * base\n    : sizeLimit?.size * unitMap[coalesce(sizeLimit?.unit, 'KB')]; // 单位 KB\n\n  return size > computedSize;\n};\n\nexport const rpx2px = rpx => Math.floor((systemInfo.windowWidth * rpx) / 750);\n\nexport const nextTick = () => new Promise((resolve) => {\n  setTimeout(() => {\n    resolve();\n  }, 33);\n});\n\n"],
  "mappings": ";AAiBO,IAAM,gBAAgB,MAAO,IAAI,gBAAgB,IAAI,cAAc,KAAK,IAAI,kBAAkB,IAAI,IAAI,kBAAkB;AAExH,IAAM,iBAAiB,MAAO,IAAI,iBAAiB,IAAI,eAAe,KAAK,IAAI,kBAAkB,IAAI,IAAI,kBAAkB;AAE3H,IAAM,gBAAgB,MAAO,IAAI,gBAAgB,IAAI,cAAc,KAAK,IAAI,kBAAkB,IAAI,IAAI,kBAAkB;;;ACfxH,IAAM,aAAa,cAAc;AAEjC,IAAM,cAAc,eAAe;AAEnC,IAAM,aAAa,cAAc;AAQjC,SAAS,YAAY,MAAM;AAEhC,WAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK,GAAG;AAEvC,QAAI,KAAK,CAAC,MAAM,QAAQ,KAAK,CAAC,MAAM,QAAW;AAC7C,aAAO,KAAK,CAAC;AAAA,IACf;AAAA,EACF;AAEA,SAAO,KAAK,KAAK,SAAS,CAAC;AAC7B;AA2IO,IAAM,YAAW,yCAAY,iBAAgB;AAE7C,IAAM,OAAO,CAAC,OAAO,SAAS,EAAE,SAAS,yCAAY,QAAQ;AAkEpE,IAAM,iBAAiB,MAAM;AAC3B,QAAM,QAAQ,gBAAgB;AAC9B,QAAM,OAAO,MAAM,MAAM,SAAS,CAAC;AACnC,SAAQ,KAAM,cAAc;AAC9B;AAGA,IAAM,eAAe,CAAC,SAAS,aAAa,iBAAiB;AAC3D,MAAI,WAAW,QAAQ,MAAM,YAAY,GAAG;AAC1C,WAAO,QAAQ,MAAM,YAAY;AAAA,EACnC;AACA,MAAI,eAAe,YAAY,MAAM,YAAY,GAAG;AAClD,WAAO,YAAY,MAAM,YAAY;AAAA,EACvC;AACA,SAAO;AACT;AAEO,IAAM,cAAc,SAAU,SAAS,UAAU;AACtD,QAAM,cAAc,eAAe;AACnC,QAAM,eAAe,QAAQ,KAAK,QAAQ,IAAI,SAAS,MAAM,CAAC,IAAI;AAClE,QAAM,WAAW,aAAa,SAAS,aAAa,YAAY;AAEhE,MAAI,CAAC,UAAU;AACb,YAAQ,KAAK,yBAAyB;AACtC,WAAO;AAAA,EACT;AACA,SAAO;AACT;",
  "names": []
}
