import{d as a,c as e,r as l,a as s,b as t,w as n,i as c,e as u,f as i,j as r,k as o,l as d,m as f,t as m,n as _,F as p,p as k,x as y,v,B as b,Q as h,s as g,K as x,E as F,G as C,H as w,z,A as D}from"./index-PUK5Iwtz.js";import{_ as M,a as j}from"./icon.CJOHyHK1.js";import{_ as B}from"./app-footer.CtOOFdq2.js";import{_ as $}from"./app-tab-bar.ikLU0SVT.js";import{u as E}from"./useFundStore.DUlJIQXw.js";const J=j(a({__name:"community-fund",setup(a){const{recordList:j,totalBalanceFormatted:J}=E(),S=e(()=>j.value.filter(a=>"contribution"===a.type).map(a=>({...a,status:`成功消费${(100*parseFloat(a.amount)).toFixed(2)}元`}))),I=e(()=>j.value),A=l(!0),H=l(0);s(()=>{setTimeout(()=>{A.value=!1},800)});const L=["基本情况","贡献列表","我的贡献"],Y=l("阳光水岸一期 1-1-802"),G=()=>{F().length>1?C():w({url:"/pages/index/index"})},K=()=>{z({title:"房屋绑定功能开发中",icon:"none"})},N=(a="all")=>{D({url:`/pages/fund/community-fund-record-list?type=${a}`})},O=a=>{D({url:`/pages/fund/community-fund-record-detail?data=${encodeURIComponent(JSON.stringify(a))}`})},P=l([{rank:1,name:"张**",amount:"156.40",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Felix"},{rank:2,name:"李**",amount:"142.85",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka"},{rank:3,name:"王**",amount:"128.60",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=John"},{rank:4,name:"赵**",amount:"115.20",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=James"},{rank:5,name:"陈**",amount:"98.55",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Caleb"}]),Q=e(()=>S.value.reduce((a,e)=>a+parseFloat(e.amount),0).toFixed(2)),R=e(()=>{const a=[],e=new Date;for(let l=5;l>=0;l--){const s=new Date(e.getFullYear(),e.getMonth()-l,1),t=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`,n=I.value.filter(a=>a.date.startsWith(t)),c=n.filter(a=>"contribution"===a.type||"initial"===a.type).reduce((a,e)=>a+parseFloat(e.amount),0),u=n.filter(a=>"expense"===a.type).reduce((a,e)=>a+parseFloat(e.amount),0);a.push({month:`${s.getMonth()+1}月`,income:parseFloat(c.toFixed(2)),expense:parseFloat(u.toFixed(2))})}return a}),T=e(()=>{const a=R.value.flatMap(a=>[a.income,a.expense]),e=Math.max(...a);return e>0?1.2*e:1});return(a,e)=>{const l=u(i("t-icon"),M),s=c,F=d,C=x,w=b,z=u(i("app-footer"),B),D=u(i("app-tab-bar"),$);return r(),t(s,{class:"page-container"},{default:n(()=>[o(s,{class:"header-section"},{default:n(()=>[o(s,{class:"header-top"},{default:n(()=>[o(s,{class:"back-btn",onClick:G},{default:n(()=>[o(l,{name:"chevron-left",size:"48rpx",color:"#fff"})]),_:1})]),_:1}),o(s,{class:"header-main"},{default:n(()=>[o(s,{class:"title-box"},{default:n(()=>[o(F,{class:"main-title"},{default:n(()=>[f("小区数字基金")]),_:1}),o(F,{class:"sub-title"},{default:n(()=>[f("你家物业费邻檬帮你减")]),_:1}),o(s,{class:"house-info",onClick:K},{default:n(()=>[o(l,{name:"swap",size:"28rpx",color:"#fff",class:"swap-icon"}),o(F,null,{default:n(()=>[f(m(Y.value),1)]),_:1})]),_:1})]),_:1}),o(s,{class:"header-illustration"},{default:n(()=>[o(s,{class:"illust-glass-card card-back"}),o(s,{class:"illust-glass-card card-front"},{default:n(()=>[o(l,{name:"chart-bubble",size:"64rpx",color:"#fff"})]),_:1}),o(s,{class:"illust-coin coin-1"}),o(s,{class:"illust-coin coin-2"})]),_:1})]),_:1}),o(s,{class:"decor-circle"})]),_:1}),o(s,{class:"tabs-container"},{default:n(()=>[(r(),_(p,null,k(L,(a,e)=>o(s,{key:e,class:y(["tab-item",{active:H.value===e}]),onClick:a=>H.value=e},{default:n(()=>[o(F,null,{default:n(()=>[f(m(a),1)]),_:2},1024),H.value===e?(r(),t(s,{key:0,class:"active-bar"})):v("",!0)]),_:2},1032,["class","onClick"])),64))]),_:1}),o(w,{"scroll-y":"",class:"content-scroll"},{default:n(()=>[A.value?(r(),t(s,{key:0,class:"tab-content skeleton-list"},{default:n(()=>[o(s,{class:"skeleton-card balance-skel"},{default:n(()=>[o(s,{class:"skeleton-item title-skel"}),o(s,{class:"skeleton-item amount-skel"})]),_:1}),o(s,{class:"skeleton-card summary-skel"},{default:n(()=>[o(s,{class:"skeleton-item title-skel"}),o(s,{class:"skeleton-item value-skel"})]),_:1}),o(s,{class:"skeleton-card chart-skel"},{default:n(()=>[o(s,{class:"skeleton-item title-skel"}),o(s,{class:"skeleton-item bars-skel"})]),_:1}),o(s,{class:"skeleton-card ranking-skel"},{default:n(()=>[o(s,{class:"skeleton-item title-skel"}),(r(),_(p,null,k(3,a=>o(s,{key:a,class:"rank-item-skel"},{default:n(()=>[o(s,{class:"skeleton-item avatar-skel"}),o(s,{class:"skeleton-item info-skel"})]),_:2},1024)),64))]),_:1})]),_:1})):0===H.value?(r(),t(s,{key:1,class:"tab-content"},{default:n(()=>[o(s,{class:"balance-card animate-slide-up",style:{"animation-delay":"0.1s"}},{default:n(()=>[o(s,{class:"balance-info"},{default:n(()=>[o(s,{class:"balance-header"},{default:n(()=>[o(F,{class:"label"},{default:n(()=>[f("小区数字基金")]),_:1}),o(F,{class:"sub-label"},{default:n(()=>[f("数据来源：邻檬智家")]),_:1})]),_:1}),o(s,{class:"balance-value"},{default:n(()=>[o(F,{class:"amount"},{default:n(()=>[f(m(h(J)),1)]),_:1}),o(F,{class:"unit"},{default:n(()=>[f("元")]),_:1})]),_:1})]),_:1}),o(s,{class:"balance-icon-box"},{default:n(()=>[o(s,{class:"coin-icon"},{default:n(()=>[f("¥")]),_:1})]),_:1})]),_:1}),o(s,{class:"contribution-summary-card animate-slide-up",style:{"animation-delay":"0.15s"},onClick:e[0]||(e[0]=a=>H.value=2)},{default:n(()=>[o(s,{class:"card-bg-decoration"},{default:n(()=>[o(s,{class:"circle-1"}),o(s,{class:"circle-2"})]),_:1}),o(s,{class:"card-content"},{default:n(()=>[o(s,{class:"summary-left"},{default:n(()=>[o(s,{class:"label-group"},{default:n(()=>[o(F,{class:"label"},{default:n(()=>[f("我的累计贡献")]),_:1})]),_:1}),o(s,{class:"summary-value"},{default:n(()=>[o(F,{class:"amount"},{default:n(()=>[f(m(Q.value),1)]),_:1}),o(F,{class:"unit"},{default:n(()=>[f("元")]),_:1})]),_:1})]),_:1}),o(s,{class:"summary-right"},{default:n(()=>[o(s,{class:"view-btn"},{default:n(()=>[o(F,null,{default:n(()=>[f("明细")]),_:1}),o(l,{name:"chevron-right",size:"24rpx",color:"#3B82F6"})]),_:1})]),_:1})]),_:1})]),_:1}),o(s,{class:"chart-card animate-slide-up",style:{"animation-delay":"0.2s"}},{default:n(()=>[o(s,{class:"chart-header"},{default:n(()=>[o(F,{class:"chart-title"},{default:n(()=>[f("小区基金收支趋势量")]),_:1}),o(s,{class:"chart-legend"},{default:n(()=>[o(s,{class:"legend-item"},{default:n(()=>[o(s,{class:"dot income"}),o(F,null,{default:n(()=>[f("收入")]),_:1})]),_:1}),o(s,{class:"legend-item"},{default:n(()=>[o(s,{class:"dot expense"}),o(F,null,{default:n(()=>[f("支出")]),_:1})]),_:1})]),_:1})]),_:1}),o(s,{class:"chart-body"},{default:n(()=>[o(s,{class:"chart-y-axis"},{default:n(()=>[o(F,null,{default:n(()=>[f(m(Math.ceil(T.value)),1)]),_:1}),o(F,null,{default:n(()=>[f(m(Math.ceil(T.value/2)),1)]),_:1}),o(F,null,{default:n(()=>[f("0")]),_:1})]),_:1}),o(s,{class:"chart-main"},{default:n(()=>[o(s,{class:"chart-grid"},{default:n(()=>[o(s,{class:"grid-line"}),o(s,{class:"grid-line"}),o(s,{class:"grid-line"})]),_:1}),o(s,{class:"bar-container"},{default:n(()=>[(r(!0),_(p,null,k(R.value,(a,e)=>(r(),t(s,{class:"bar-group",key:e},{default:n(()=>[o(s,{class:"bars"},{default:n(()=>[o(s,{class:"bar income animate-grow-up",style:g({height:a.income/T.value*100+"%",animationDelay:.4+.1*e+"s"})},{default:n(()=>[a.income>.5?(r(),t(F,{key:0,class:"bar-value"},{default:n(()=>[f(m(a.income),1)]),_:2},1024)):v("",!0)]),_:2},1032,["style"]),o(s,{class:"bar expense animate-grow-up",style:g({height:a.expense/T.value*100+"%",animationDelay:.5+.1*e+"s"})},{default:n(()=>[a.expense>.5?(r(),t(F,{key:0,class:"bar-value"},{default:n(()=>[f(m(a.expense),1)]),_:2},1024)):v("",!0)]),_:2},1032,["style"])]),_:2},1024),o(F,{class:"bar-label"},{default:n(()=>[f(m(a.month),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),o(s,{class:"chart-footer"},{default:n(()=>[o(F,{class:"unit-text"},{default:n(()=>[f("单位：元")]),_:1})]),_:1})]),_:1}),o(s,{class:"ranking-card animate-slide-up",style:{"animation-delay":"0.25s"}},{default:n(()=>[o(s,{class:"ranking-header"},{default:n(()=>[o(s,{class:"title-group"},{default:n(()=>[o(l,{name:"chart-bar",size:"36rpx",color:"#F59E0B"}),o(F,{class:"ranking-title"},{default:n(()=>[f("贡献排行榜")]),_:1})]),_:1}),o(F,{class:"ranking-subtitle"},{default:n(()=>[f("前五榜单")]),_:1})]),_:1}),o(s,{class:"ranking-list"},{default:n(()=>[(r(!0),_(p,null,k(P.value,(a,e)=>(r(),t(s,{class:"ranking-item animate-fade-in",key:e,style:g({animationDelay:.3+.05*e+"s"})},{default:n(()=>[o(s,{class:y(["rank-num","rank-"+a.rank])},{default:n(()=>[a.rank>3?(r(),t(F,{key:0},{default:n(()=>[f(m(a.rank),1)]),_:2},1024)):(r(),t(l,{key:1,name:"measurement-1",size:"32rpx"}))]),_:2},1032,["class"]),o(C,{class:"user-avatar",src:a.avatar,mode:"aspectFill"},null,8,["src"]),o(s,{class:"user-info"},{default:n(()=>[o(F,{class:"user-name"},{default:n(()=>[f(m(a.name),1)]),_:2},1024)]),_:2},1024),o(s,{class:"user-amount"},{default:n(()=>[o(F,{class:"amount-val"},{default:n(()=>[f(m(a.amount),1)]),_:2},1024),o(F,{class:"amount-unit"},{default:n(()=>[f("元")]),_:1})]),_:2},1024)]),_:2},1032,["style"]))),128))]),_:1})]),_:1})]),_:1})):1===H.value?(r(),t(s,{key:2,class:"tab-content"},{default:n(()=>[(r(!0),_(p,null,k(I.value.slice(0,5),(a,e)=>(r(),t(s,{class:"record-item animate-slide-up",key:e,style:g({animationDelay:.1*e+"s"}),onClick:e=>O(a)},{default:n(()=>[o(s,{class:"record-left"},{default:n(()=>[o(s,{class:"record-info"},{default:n(()=>[o(s,{class:"title-row"},{default:n(()=>[o(F,{class:"record-title"},{default:n(()=>[f(m(a.title),1)]),_:2},1024),o(F,{class:y(["scene-tag","online"===a.scene?"online":"offline"])},{default:n(()=>[f(m("online"===a.scene?"线上":"线下"),1)]),_:2},1032,["class"])]),_:2},1024),o(F,{class:"record-date"},{default:n(()=>[f(m(a.date),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(s,{class:"record-right"},{default:n(()=>[o(F,{class:y(["record-amount","expense"===a.type?"expense":"contribution"])},{default:n(()=>[f(m("expense"===a.type?"-":"+")+m(a.amount)+"元 ",1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["style","onClick"]))),128)),I.value.length>5?(r(),t(s,{key:0,class:"view-more-btn animate-fade-in",style:{"animation-delay":"0.6s"},onClick:e[1]||(e[1]=a=>N("all"))},{default:n(()=>[o(F,null,{default:n(()=>[f("查看更多明细")]),_:1}),o(l,{name:"chevron-right",size:"32rpx"})]),_:1})):v("",!0),0===I.value.length?(r(),t(s,{key:1,class:"empty-state animate-fade-in"},{default:n(()=>[o(l,{name:"info-circle",size:"64rpx",color:"#CBD5E1"}),o(F,null,{default:n(()=>[f("暂无贡献记录")]),_:1})]),_:1})):v("",!0)]),_:1})):2===H.value?(r(),t(s,{key:3,class:"tab-content"},{default:n(()=>[(r(!0),_(p,null,k(S.value.slice(0,5),(a,e)=>(r(),t(s,{class:"record-item animate-slide-up",key:e,style:g({animationDelay:.1*e+"s"}),onClick:e=>O(a)},{default:n(()=>[o(s,{class:"record-left"},{default:n(()=>[o(s,{class:"record-info"},{default:n(()=>[o(s,{class:"title-row"},{default:n(()=>[o(F,{class:"record-title"},{default:n(()=>[f(m(a.title),1)]),_:2},1024),o(F,{class:y(["scene-tag","online"===a.scene?"online":"offline"])},{default:n(()=>[f(m("online"===a.scene?"线上":"线下"),1)]),_:2},1032,["class"])]),_:2},1024),o(F,{class:"record-status"},{default:n(()=>[f(m(a.status),1)]),_:2},1024),o(F,{class:"record-date"},{default:n(()=>[f(m(a.date),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),o(s,{class:"record-right"},{default:n(()=>[o(F,{class:"record-amount contribution"},{default:n(()=>[f(" +"+m(a.amount)+"元 ",1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style","onClick"]))),128)),S.value.length>5?(r(),t(s,{key:0,class:"view-more-btn animate-fade-in",style:{"animation-delay":"0.6s"},onClick:e[2]||(e[2]=a=>N("mine"))},{default:n(()=>[o(F,null,{default:n(()=>[f("查看更多明细")]),_:1}),o(l,{name:"chevron-right",size:"32rpx"})]),_:1})):v("",!0),0===S.value.length?(r(),t(s,{key:1,class:"empty-state animate-fade-in"},{default:n(()=>[o(l,{name:"info-circle",size:"64rpx",color:"#CBD5E1"}),o(F,null,{default:n(()=>[f("暂无贡献记录")]),_:1})]),_:1})):v("",!0)]),_:1})):v("",!0)]),_:1}),o(z),o(D,{activePath:"pages/index/index"})]),_:1})}}}),[["__scopeId","data-v-7dd578c5"]]);export{J as default};
