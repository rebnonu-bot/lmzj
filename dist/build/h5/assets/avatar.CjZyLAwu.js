import{_ as a}from"./loading.CTjU6Yd3.js";import{e,f as s,j as t,b as i,w as o,i as l,x as r,s as n,m as d,t as c,R as h,k as p,v as m,K as g}from"./index-8WK0Ux_r.js";import{u,_ as f,p as y,j as x,k as S,l as b,t as _,a as P,m as z,s as w,o as C}from"./icon.CNXA9uzs.js";import{_ as L}from"./badge.Dporcbm2.js";import{R as $}from"./parent-map.DLFD9qfo.js";import{C as k}from"./relation.DsLEl_h2.js";const v={error:{type:String,default:"default"},height:{type:[String,Number]},lazy:Boolean,loading:{type:String,default:"default"},mode:{type:String,default:"scaleToFill",validator:a=>!a||["scaleToFill","aspectFit","aspectFill","widthFix","heightFix","top","bottom","center","left","right","top left","top right","bottom left","bottom right"].includes(a)},shape:{type:String,default:"square",validator:a=>!a||["circle","round","square"].includes(a)},showMenuByLongpress:Boolean,src:{type:String,default:""},tId:{type:String,default:""},webp:Boolean,width:{type:[String,Number]},onError:{type:Function,default:()=>({})},onLoad:{type:Function,default:()=>({})}},F=`${y}-image`;const j=P(u({name:F,options:{styleIsolation:"shared"},externalClasses:[`${y}-class`,`${y}-class-load`,`${y}-class-image`,`${y}-class-error`],components:{TLoading:a,TIcon:f},props:{...v},emits:["click"],data:()=>({prefix:y,isLoading:!0,isFailed:!1,innerStyle:"",classPrefix:F,tools:_,preSrc:""}),watch:{src(){this.preSrc!==this.src&&this.update()},width:"calcSize",height:"calcSize"},mounted(){this.calcSize(this.width,this.height)},methods:{onLoaded(a){const e=S.SDKVersion,{mode:s,tId:t}=this;b(e,"2.10.3"),this.isLoading=!1,this.isFailed=!1,this.$emit("load",{e:a})},onLoadError(a){this.isLoading=!1,this.isFailed=!0,this.$emit("error",{e:a})},calcSize(a=this.width,e=this.height){let s="";a&&(s+=`width: ${x(a)};`),e&&(s+=`height: ${x(e)};`),this.innerStyle=s},update(){const{src:a}=this;this.preSrc=a,a?(this.isLoading=!0,this.isFailed=!1):this.onLoadError({errMsg:"图片链接为空"})},onClick(a){this.$emit("click",a)}}}),[["render",function(u,y,x,S,b,_){const P=e(s("t-loading"),a),z=l,w=e(s("t-icon"),f),C=g;return t(),i(z,{style:n(u.tools._style([u.customStyle])),class:r([u.tClass,u.classPrefix])},{default:o(()=>[u.isLoading?(t(),i(z,{key:0,style:n(u.tools._style([u.innerStyle])),class:r(u.classPrefix+"__mask "+u.classPrefix+"--loading "+u.classPrefix+"--shape-"+u.shape),"aria-hidden":u.ariaHidden},{default:o(()=>["default"===u.loading?(t(),i(P,{key:0,theme:"dots",size:"44rpx",loading:"","inherit-color":"","t-class":u.tClassLoad,"t-class-text":u.classPrefix+"--loading-text"},null,8,["t-class","t-class-text"])):""!==u.loading&&"slot"!==u.loading?(t(),i(z,{key:1,class:r(u.classPrefix+"__common "+u.tClassLoad)},{default:o(()=>[d(c(u.loading),1)]),_:1},8,["class"])):h(u.$slots,"loading",{key:2},void 0,!0)]),_:3},8,["style","class","aria-hidden"])):u.isFailed?(t(),i(z,{key:1,style:n(u.tools._style([u.innerStyle])),class:r([u.classPrefix+"__mask "+u.classPrefix+"--failed "+u.classPrefix+"--shape-"+u.shape,u.tClassError]),"aria-hidden":u.ariaHidden},{default:o(()=>["default"===u.error?(t(),i(z,{key:0,style:{"font-size":"44rpx"},class:r(u.tClassLoad)},{default:o(()=>[p(w,{name:"close","aria-role":"img","aria-label":"加载失败"})]),_:1},8,["class"])):u.error&&"slot"!==u.error?(t(),i(z,{key:1,class:r([u.classPrefix+"__common ",u.tClassLoad])},{default:o(()=>[d(c(u.error),1)]),_:1},8,["class"])):h(u.$slots,"error",{key:2},void 0,!0)]),_:3},8,["style","class","aria-hidden"])):m("",!0),u.isFailed?m("",!0):(t(),i(C,{key:2,id:u.tId||"image",style:n(u.tools._style([u.innerStyle])),class:r([u.classPrefix+"__img "+u.classPrefix+"--shape-"+u.shape+" ",(u.isLoading?u.classPrefix+"--lazy":"")+" ",u.tClassImage]),src:u.src,mode:u.mode,webp:u.webp,"lazy-load":u.lazy,"show-menu-by-longpress":u.showMenuByLongpress,"aria-hidden":u.ariaHidden||u.isLoading||u.isFailed,"aria-label":u.ariaLabel,onClick:u.onClick,onLoad:u.onLoaded,onError:u.onLoadError},null,8,["id","style","class","src","mode","webp","lazy-load","show-menu-by-longpress","aria-hidden","aria-label","onClick","onLoad","onError"]))]),_:3},8,["style","class"])}],["__scopeId","data-v-601401b0"]]),I={alt:{type:String,default:""},badgeProps:{type:Object,default:()=>({})},bordered:Boolean,hideOnLoadFailed:Boolean,icon:{type:[String,Object]},image:{type:String,default:""},imageProps:{type:Object},shape:{type:String,validator:a=>!a||["circle","round"].includes(a)},size:{type:String,default:""},onError:{type:Function,default:()=>({})}};const D=Object.freeze(Object.defineProperty({__proto__:null,getClass:function(a,e,s,t){const i=(e||"").indexOf("px")>-1;return[a,a+("round"===s?"--round":"--circle"),t?`${a}--border ${a}--border-${i?"medium":e}`:"",i?"":`${a}--${e}`].join(" ")},getSize:function(a="medium",e){const s=z("^([0-9]+)(px|rpx)$").exec(a);if(s&&s.length>=3){let t=s[1];return"rpx"===s[2]&&(t=Math.floor(e*s[1]/750)),`width:${a};height:${a};font-size:${t/8*3+2}px`}},getStyles:function(a){return a?"":"display: none;"}},Symbol.toStringTag,{value:"Module"})),E=`${y}-avatar`;const B=P(u({name:E,options:{styleIsolation:"shared"},externalClasses:[`${y}-class`,`${y}-class-image`,`${y}-class-icon`,`${y}-class-alt`,`${y}-class-content`],mixins:[k($.Avatar)],components:{TIcon:f,TBadge:L,TImage:j},props:{...I},data(){return{prefix:y,classPrefix:E,isShow:!0,zIndex:0,windowWidth:w.windowWidth,utils:D,tools:_,iconName:"",iconData:{},dataShape:this.shape,dataSize:this.size,dataBordered:this.bordered,innerStyle:""}},computed:{iconCustomStyle(){const a={small:"var(--td-avatar-icon-small-font-size, 20px)",medium:"var(--td-avatar-icon-medium-font-size, 24px)",large:"var(--td-avatar-icon-large-font-size, 32px)"};return a[this.dataSize]?_._style([{fontSize:a[this.dataSize]},this.iconData.style||""]):""},imageCustomStyle(){var a;return _._style([{width:"100%",height:"100%"},(null==(a=this.imageProps)?void 0:a.style)||""])}},watch:{icon:{handler(a){const e=C("icon",a,"");Object.keys(e).forEach(a=>{this[a]=e[a]})},immediate:!0}},mounted(){},methods:{innerAfterLinked(){var a,e;this.dataShape=this.shape||(null==(a=this[$.Avatar])?void 0:a.shape)||"circle",this.dataSize=this.size||(null==(e=this[$.Avatar])?void 0:e.size),this.dataBordered=!0},hide(){this.isShow=!1},onLoadError(a){this.hideOnLoadFailed&&(this.isShow=!1),this.$emit("error",a&&a.e)},setStyle(a=""){this.innerStyle=a}}}),[["render",function(a,d,c,g,u,y){const x=e(s("t-image"),j),S=e(s("t-icon"),f),b=l,_=e(s("t-badge"),L);return t(),i(b,{class:r([a.classPrefix+"__wrapper",a.tClass]),style:n(a.tools._style([a.utils.getStyles(a.isShow),a.customStyle,a.innerStyle]))},{default:o(()=>[a.badgeProps?(t(),i(_,{key:0,color:a.badgeProps.color||"",content:a.badgeProps.content||"",count:a.badgeProps.count||0,dot:a.badgeProps.dot||!1,"max-count":a.badgeProps.maxCount||99,offset:a.badgeProps.offset||[],shape:a.badgeProps.shape||"circle","show-zero":a.badgeProps.showZero||!1,size:a.badgeProps.size||"medium","t-class":a.badgeProps.tClass,"t-class-content":a.badgeProps.tClassContent,"t-class-count":a.badgeProps.tClassCount},{default:o(()=>[p(b,{class:r([a.utils.getClass(a.classPrefix,a.dataSize||"medium",a.dataShape,a.dataBordered),a.tClassImage]),style:n(a.utils.getSize(a.dataSize,a.windowWidth)),"aria-label":a.ariaLabel||a.alt||"头像","aria-role":a.ariaRole||"img","aria-hidden":a.ariaHidden},{default:o(()=>[a.image?(t(),i(x,{key:0,"t-class":a.prefix+"-image "+a.classPrefix+"__image","t-class-load":a.tClassAlt,"custom-style":a.imageCustomStyle,style:{width:"100%",height:"100%"},src:a.image,mode:a.imageProps&&a.imageProps.mode||"aspectFill",lazy:a.imageProps&&a.imageProps.lazy||!1,loading:a.imageProps&&a.imageProps.loading||"default",shape:a.imageProps&&a.imageProps.shape||"round",webp:a.imageProps&&a.imageProps.webp||!1,error:a.alt||"default",onError:a.onLoadError},null,8,["t-class","t-class-load","custom-style","src","mode","lazy","loading","shape","webp","error","onError"])):a.iconName||a.tools.isNoEmptyObj(a.iconData)?(t(),i(S,{key:1,"t-class":a.classPrefix+"__icon "+a.classPrefix+"__icon--"+(a.iconData.activeIdx==a.iconData.index?"active ":" ")+a.tClassIcon,prefix:a.iconData.prefix,name:a.iconName||a.iconData.name,size:a.iconData.size,color:a.iconData.color,"aria-hidden":!!a.iconData.ariaHidden,"aria-label":a.iconData.ariaLabel,"aria-role":a.iconData.ariaRole,"custom-style":a.iconCustomStyle,onClick:d[0]||(d[0]=e=>a.iconData.click||"")},null,8,["t-class","prefix","name","size","color","aria-hidden","aria-label","aria-role","custom-style"])):(t(),i(b,{key:2,class:r([a.classPrefix+"__text ",a.tClassContent])},{default:o(()=>[h(a.$slots,"default",{},void 0,!0)]),_:3},8,["class"]))]),_:3},8,["class","style","aria-label","aria-role","aria-hidden"])]),_:3},8,["color","content","count","dot","max-count","offset","shape","show-zero","size","t-class","t-class-content","t-class-count"])):m("",!0)]),_:3},8,["class","style"])}],["__scopeId","data-v-f6b073cf"]]);export{B as _,j as a};
