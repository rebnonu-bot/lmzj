import{d as e,r as a,J as l,c as s,b as t,w as c,i as o,e as r,f as n,j as d,k as u,B as i,m as f,l as p,K as m,v as _,x as h,t as v,L as k,E as b,G as C,C as x,M as g,N as y,z as B,O as A,P as D}from"./index-PUK5Iwtz.js";import{_ as F,a as w}from"./icon.CJOHyHK1.js";import{_ as z}from"./navbar.COTAEQY7.js";import{_ as j}from"./input.laCmRd_z.js";import{_ as T}from"./button.GJ5z5xt4.js";import"./parent-map.DLFD9qfo.js";import"./loading.NVpDzvTL.js";const V=w(e({__name:"auth",setup(e){const w=a(!1),V=a(!1),E=a(60);let I=null;const U=l({idCardFront:"",idCardBack:"",phone:"",code:"",faceAuthDone:!1}),G=s(()=>U.idCardFront&&U.idCardBack&&11===U.phone.length&&6===U.code.length&&U.faceAuthDone&&w.value),M=s(()=>/^1[3-9]\d{9}$/.test(U.phone)),N=()=>{b().length>1?C():x({url:"/pages/mine/mine"})},P=()=>{g({title:"实名认证服务协议",content:"这里是协议内容预览...",showCancel:!1})},$=e=>{y({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:a=>{const l=a.tempFilePaths[0];l&&("front"===e?U.idCardFront=l:U.idCardBack=l)}})},H=()=>{V.value||11!==U.phone.length||(B({title:"验证码已发送",icon:"none"}),V.value=!0,I=setInterval(()=>{E.value>1?E.value--:(clearInterval(I),V.value=!1,E.value=60)},1e3))},J=()=>{U.faceAuthDone||(A({title:"启动人脸识别"}),setTimeout(()=>{D(),g({title:"人脸识别",content:"模拟人脸识别成功",showCancel:!1,success:()=>{U.faceAuthDone=!0}})},1500))},K=()=>{A({title:"提交审核中"}),setTimeout(()=>{D(),B({title:"提交成功，请耐心等待审核",icon:"success",duration:2e3}),setTimeout(()=>{N()},2e3)},1500)};return(e,a)=>{const l=r(n("t-icon"),F),s=r(n("t-navbar"),z),b=o,C=p,x=m,g=r(n("t-input"),j),y=i,B=r(n("t-button"),T);return d(),t(b,{class:"page-container"},{default:c(()=>[u(s,{title:"实名认证","left-arrow":"",onGoBack:N,fixed:!1,class:"custom-navbar"},{"left-icon":c(()=>[u(l,{name:"chevron-left",size:"48rpx",color:"#1E293B"})]),_:1}),u(b,{class:"header-bg"}),u(y,{"scroll-y":"",class:"auth-scroll"},{default:c(()=>[u(b,{class:"content-wrapper"},{default:c(()=>[u(b,{class:"section-card"},{default:c(()=>[u(b,{class:"section-title"},{default:c(()=>[f("身份证上传")]),_:1}),u(b,{class:"id-card-grid"},{default:c(()=>[u(b,{class:"id-card-item",onClick:a[0]||(a[0]=e=>$("front"))},{default:c(()=>[U.idCardFront?(d(),t(x,{key:1,src:U.idCardFront,mode:"aspectFill",class:"preview-img"},null,8,["src"])):(d(),t(b,{key:0,class:"upload-box"},{default:c(()=>[u(l,{name:"camera",size:"64rpx",color:"#94A3B8"}),u(C,{class:"upload-text"},{default:c(()=>[f("身份证人像面")]),_:1})]),_:1})),U.idCardFront?(d(),t(b,{key:2,class:"re-upload"},{default:c(()=>[f("点击重传")]),_:1})):_("",!0)]),_:1}),u(b,{class:"id-card-item",onClick:a[1]||(a[1]=e=>$("back"))},{default:c(()=>[U.idCardBack?(d(),t(x,{key:1,src:U.idCardBack,mode:"aspectFill",class:"preview-img"},null,8,["src"])):(d(),t(b,{key:0,class:"upload-box"},{default:c(()=>[u(l,{name:"camera",size:"64rpx",color:"#94A3B8"}),u(C,{class:"upload-text"},{default:c(()=>[f("身份证国徽面")]),_:1})]),_:1})),U.idCardBack?(d(),t(b,{key:2,class:"re-upload"},{default:c(()=>[f("点击重传")]),_:1})):_("",!0)]),_:1})]),_:1}),u(b,{class:"tips"},{default:c(()=>[f("请确保身份证姓名、证件号码清晰可见，无反光、无遮挡")]),_:1})]),_:1}),u(b,{class:"section-card mt-24"},{default:c(()=>[u(b,{class:"section-title"},{default:c(()=>[f("手机号验证")]),_:1}),u(b,{class:"input-group"},{default:c(()=>[u(g,{modelValue:U.phone,"onUpdate:modelValue":a[2]||(a[2]=e=>U.phone=e),label:"手机号",placeholder:"请输入手机号",type:"number",maxlength:"11",borderless:""},null,8,["modelValue"]),u(b,{class:"verify-code-row"},{default:c(()=>[u(g,{modelValue:U.code,"onUpdate:modelValue":a[3]||(a[3]=e=>U.code=e),label:"验证码",placeholder:"请输入验证码",type:"number",maxlength:"6",borderless:""},{suffix:c(()=>[u(b,{class:h(["code-btn",{disabled:V.value||!M.value}]),onClick:H},{default:c(()=>[f(v(V.value?`${E.value}s后重发`:"获取验证码"),1)]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),u(b,{class:"section-card mt-24"},{default:c(()=>[u(b,{class:"section-title"},{default:c(()=>[f("人脸识别绑定")]),_:1}),u(b,{class:h(["face-auth-item",{success:U.faceAuthDone}]),onClick:J},{default:c(()=>[u(b,{class:"left-info"},{default:c(()=>[u(b,{class:h(["icon-box",{success:U.faceAuthDone}])},{default:c(()=>[u(l,{name:U.faceAuthDone?"check":"user-smile",size:"40rpx",color:U.faceAuthDone?"#10B981":"#3B82F6"},null,8,["name","color"])]),_:1},8,["class"]),u(C,{class:"label"},{default:c(()=>[f(v(U.faceAuthDone?"已完成人脸识别":"去完成人脸识别"),1)]),_:1})]),_:1}),U.faceAuthDone?_("",!0):(d(),t(l,{key:0,name:"chevron-right",size:"32rpx",color:"#CBD5E1"}))]),_:1},8,["class"])]),_:1}),u(b,{class:"protocol-row",onClick:a[4]||(a[4]=e=>w.value=!w.value)},{default:c(()=>[u(l,{name:w.value?"check-circle-filled":"circle",size:"36rpx",color:w.value?"@primary-blue":"#CBD5E1"},null,8,["name","color"]),u(b,{class:"protocol-text"},{default:c(()=>[f(" 阅读并同意"),u(C,{class:"link",onClick:k(P,["stop"])},{default:c(()=>[f("《实名认证服务协议》")]),_:1})]),_:1})]),_:1})]),_:1}),u(b,{class:"bottom-padding"})]),_:1}),u(b,{class:"footer-actions"},{default:c(()=>[u(B,{theme:"primary",size:"large",block:"",shape:"round",disabled:!G.value,onClick:K},{default:c(()=>[f(" 提交认证 ")]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-259876c7"]]);export{V as default};
