import{p as t,s as e,u as s,t as a,a as o,_ as i}from"./icon.CJOHyHK1.js";import{j as n,b as l,w as r,i as c,L as u,s as d,x as p,R as h,v,e as m,f as y,k as b}from"./index-PUK5Iwtz.js";const f={backgroundColor:{type:String,default:""},duration:{type:Number,default:300},preventScrollThrough:{type:Boolean,default:!0},usingCustomNavbar:Boolean,visible:Boolean,zIndex:{type:Number,default:11e3},onClick:{type:Function,default:()=>({})}};function g(){return{data:()=>({transitionClass:"",transitionDurations:300,className:"",realVisible:!1}),props:{visible:{type:Boolean,default:null},appear:Boolean,name:{type:String,default:"fade"},durations:{type:Number,optionalTypes:[Array]}},watch:{visible:{handler(t,e){this.watchVisible(t,e)}}},created(){this.status="",this.transitionT=0},beforeMount(){this.dataDurations=this.getDurations(),this.visible&&this.enter(),this.inited=!0},destroyed(){clearTimeout(this.transitionT)},methods:{watchVisible(t,e){this.inited&&t!==e&&(t?this.enter():this.leave())},getDurations(){const{durations:t}=this;return Array.isArray(t)?t.map(t=>Number(t)):[Number(t),Number(t)]},enter(){const{name:e,transitionDurations:s}=this,[a]=this.dataDurations;this.status="entering",this.realVisible=!0,this.transitionClass=`${t}-${e}-enter ${t}-${e}-enter-active`,setTimeout(()=>{this.transitionClass=`${t}-${e}-enter-active ${t}-${e}-enter-to`},30),this.transitionT="number"==typeof a&&a>0?setTimeout(this.entered.bind(this),a+30):setTimeout("leaving"===this.status?this.leaved.bind(this):()=>{},s+30)},entered(){this.customDuration=!1,clearTimeout(this.transitionT),this.status="entered",this.transitionClass=""},leave(){const{name:e,transitionDurations:s}=this,[,a]=this.dataDurations;this.status="leaving",this.transitionClass=`${t}-${e}-leave  ${t}-${e}-leave-active`,clearTimeout(this.transitionT),setTimeout(()=>{this.transitionClass=`${t}-${e}-leave-active ${t}-${e}-leave-to`},30),"number"==typeof a&&a>0?(this.customDuration=!0,this.transitionT=setTimeout(this.leaved.bind(this),a+30)):this.transitionT=setTimeout("leaving"===this.status?this.leaved.bind(this):()=>{},s+30)},leaved(){this.customDuration=!1,this.$emit("leaved"),clearTimeout(this.transitionT),this.status="leaved",this.transitionClass="",this.realVisible=!1},onTransitionEnd(){this.customDuration||(clearTimeout(this.transitionT),"entering"===this.status&&this.visible?this.entered():"leaving"!==this.status||this.visible||this.leaved())}}}}const T=g(),C={data:()=>({distanceTop:0}),props:{usingCustomNavbar:{type:Boolean,default:!1},customNavbarHeight:{type:Number,default:0}},created(){this.usingCustomNavbar&&this.calculateCustomNavbarDistanceTop()},methods:{calculateCustomNavbarDistanceTop(){const{statusBarHeight:t}=e;this.distanceTop=Math.max(0,this.customNavbarHeight+t)}}},x=`${t}-overlay`;const $=o(s({name:x,options:{styleIsolation:"shared"},mixins:[g(),C],props:{...f},emits:["click","leaved"],data:()=>({prefix:t,classPrefix:x,computedStyle:"",_zIndex:11e3,tools:a}),watch:{backgroundColor:{handler(t){this.computedStyle=t?`background-color: ${t};`:""},immediate:!0},zIndex:{handler(t){0!==t&&(this._zIndex=t)},immediate:!0}},methods:{handleClick(){this.$emit("click",{visible:!this.visible})},noop(){}}}),[["render",function(t,e,s,a,o,i){const m=c;return n(),l(m,null,{default:r(()=>[t.realVisible&&t.preventScrollThrough?(n(),l(m,{key:0,class:p(t.prefix+"-overlay "+t.transitionClass),style:d(t.tools._style(["--td-overlay-transition-duration:"+t.duration+"ms","z-index:"+t._zIndex,"top:"+t.distanceTop+"px",t.computedStyle,t.customStyle])),"aria-role":t.ariaRole||"button","aria-label":t.ariaLabel||"关闭","disable-scroll":"",onClick:u(t.handleClick,["stop"]),onTouchmove:u(t.noop,["stop","prevent"]),onTransitionend:t.onTransitionEnd},{default:r(()=>[h(t.$slots,"default",{},void 0,!0)]),_:3},8,["class","style","aria-role","aria-label","onClick","onTouchmove","onTransitionend"])):t.realVisible?(n(),l(m,{key:1,class:p(t.prefix+"-overlay "+t.transitionClass),style:d(t.tools._style(["z-index:"+t._zIndex,"top:"+t.distanceTop+"px",t.computedStyle,t.customStyle])),"aria-role":t.ariaRole||"button","aria-label":t.ariaLabel||"关闭",onClick:u(t.handleClick,["stop"]),onTransitionend:t.onTransitionEnd},{default:r(()=>[h(t.$slots,"default",{},void 0,!0)]),_:3},8,["class","style","aria-role","aria-label","onClick","onTransitionend"])):v("",!0)]),_:3})}],["__scopeId","data-v-33c94baa"]]),k={closeBtn:{type:Boolean},closeOnOverlayClick:{type:Boolean,default:!0},content:{type:String},duration:{type:Number,default:240},overlayProps:{type:Object,default:()=>({})},placement:{type:String,default:"top",validator:t=>!t||["top","left","right","bottom","center"].includes(t)},preventScrollThrough:{type:Boolean,default:!0},showOverlay:{type:Boolean,default:!0},usingCustomNavbar:Boolean,visible:Boolean,defaultVisible:Boolean,zIndex:{type:Number,default:11500},onVisibleChange:{type:Function,default:()=>({})}};const _={getPopupStyles:function({zIndex:t,distanceTop:e,placement:s,duration:a}){let o=t?`z-index:${t};`:"";return"top"!==s&&"left"!==s&&"right"!==s||!e||(o=`${o}top:${e}px;--td-popup-distance-top:${e}px;`),a&&(o=`${o}--td-popup-transition:all ${a}ms ease;`),o}};delete k.visible;const P=`${t}-popup`;const S=o(s({name:P,options:{styleIsolation:"shared"},externalClasses:[`${t}-class`,`${t}-class-content`],mixins:[T,C],components:{TOverlay:$,TIcon:i},props:{...k},emits:["visible-change","leaved","update:visible"],data:()=>({prefix:t,classPrefix:P,popup:_,tools:a}),computed:{innerPreventScrollThrough(){const{preventScrollThrough:t,overlayProps:e}=this;return t||!!e&&!!e.preventScrollThrough}},methods:{noop(){},handleOverlayClick(){const{closeOnOverlayClick:t}=this;t&&(this.$emit("visible-change",{visible:!1,trigger:"overlay"}),this.$emit("update:visible",!1))},handleClose(){this.$emit("visible-change",{visible:!1,trigger:"close-btn"}),this.$emit("update:visible",!1)}}}),[["render",function(t,e,s,a,o,f){const g=m(y("t-icon"),i),T=c,C=m(y("t-overlay"),$);return n(),l(T,null,{default:r(()=>[t.realVisible?(n(),l(T,{key:0,style:d(t.tools._style([t.popup.getPopupStyles({zIndex:t.zIndex,distanceTop:t.distanceTop,placement:t.placement,duration:t.duration}),t.customStyle])),class:p(t.tools.cls(t.classPrefix,[t.placement])+" "+t.transitionClass+" "+t.tClass),onTransitionend:t.onTransitionEnd},{default:r(()=>[t.innerPreventScrollThrough?(n(),l(T,{key:0,class:p(t.classPrefix+"__content "+t.tClassContent),onTouchmove:u(t.noop,["stop","prevent"])},{default:r(()=>[h(t.$slots,"content",{},void 0,!0),h(t.$slots,"default",{},void 0,!0),b(T,{class:p(t.classPrefix+"__close"),onClick:t.handleClose},{default:r(()=>[t.closeBtn?(n(),l(g,{key:0,name:"close",size:"64rpx"})):v("",!0),h(t.$slots,"close-btn",{class:p(t.classPrefix+"-slot")},void 0,!0)]),_:3},8,["class","onClick"])]),_:3},8,["class","onTouchmove"])):(n(),l(T,{key:1,class:p(t.classPrefix+"__content "+t.tClassContent)},{default:r(()=>[h(t.$slots,"content",{},void 0,!0),h(t.$slots,"default",{},void 0,!0),b(T,{class:p(t.classPrefix+"__close"),onClick:t.handleClose},{default:r(()=>[t.closeBtn?(n(),l(g,{key:0,name:"close",size:"64rpx"})):v("",!0),h(t.$slots,"close-btn",{class:p(t.classPrefix+"-slot")},void 0,!0)]),_:3},8,["class","onClick"])]),_:3},8,["class"]))]),_:3},8,["style","class","onTransitionend"])):v("",!0),t.showOverlay?(n(),l(C,{key:1,id:"popup-overlay",visible:t.visible,"using-custom-navbar":t.usingCustomNavbar,"custom-navbar-height":t.customNavbarHeight,"z-index":t.overlayProps&&t.overlayProps.zIndex||11e3,duration:t.overlayProps&&t.overlayProps.duration||t.duration||300,"background-color":t.overlayProps&&t.overlayProps.backgroundColor||"","prevent-scroll-through":t.preventScrollThrough||!!t.overlayProps&&!!t.overlayProps.preventScrollThrough,"custom-style":t.overlayProps&&t.overlayProps.style||"",onClick:e[0]||(e[0]=e=>t.handleOverlayClick(e,{tagId:"popup-overlay"}))},null,8,["visible","using-custom-navbar","custom-navbar-height","z-index","duration","background-color","prevent-scroll-through","custom-style"])):v("",!0)]),_:3})}],["__scopeId","data-v-7e69e61d"]]);export{S as _,C as u};
