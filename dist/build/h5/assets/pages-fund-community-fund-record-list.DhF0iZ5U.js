import{d as e,r as a,c as l,D as t,b as s,w as u,i as o,e as r,f as n,j as c,k as i,l as d,m as v,t as f,B as p,n as m,F as _,p as b,s as y,x,v as k,G as j}from"./index-PUK5Iwtz.js";import{_ as g}from"./navbar.COTAEQY7.js";import{_ as F,a as $}from"./icon.CJOHyHK1.js";import{_ as w,a as S}from"./picker.n8KcBAOD.js";import{u as h}from"./useFundStore.DUlJIQXw.js";import"./parent-map.DLFD9qfo.js";import"./relation.DOrZf5Wr.js";import"./popup.DXni-6bZ.js";const B=$(e({__name:"community-fund-record-list",setup(e){const{recordList:$}=h(),B=a("all"),C=l(()=>"mine"===B.value?"我的贡献明细":"贡献列表明细"),D=a(!1),z=a(""),G=a(""),L=l(()=>z.value&&G.value?`${z.value}年${G.value}月`:"全部记录"),E=l(()=>z.value&&G.value?`${z.value}-${G.value}`:""),H=l(()=>{const e=(new Date).getFullYear(),a=[{label:"全部年份",value:""}];for(let l=e-5;l<=e;l++)a.push({label:`${l}年`,value:l.toString()});return a}),I=l(()=>{const e=[{label:"全部月份",value:""}];for(let a=1;a<=12;a++)e.push({label:`${a}月`,value:a.toString().padStart(2,"0")});return e}),O=a([]),R=a(!1);t(e=>{e.type&&(B.value=e.type),T()});const T=()=>{"mine"===B.value?O.value=$.value.filter(e=>"contribution"===e.type).map(e=>({...e,status:`成功消费${(100*parseFloat(e.amount)).toFixed(2)}元`})):O.value=$.value},U=l(()=>E.value?O.value.filter(e=>e.date.startsWith(E.value)):O.value),W=l(()=>U.value.reduce((e,a)=>{const l=parseFloat(a.amount);return"expense"===a.type?e-l:e+l},0).toFixed(2)),X=()=>{j()},Y=e=>{z.value=e.value[0],G.value=e.value[1],D.value=!1},q=()=>{};return(e,a)=>{const l=r(n("t-navbar"),g),t=d,j=r(n("t-icon"),F),$=o,h=p,B=r(n("t-picker-item"),w),E=r(n("t-picker"),S);return c(),s($,{class:"page-container"},{default:u(()=>[i(l,{title:C.value,"left-arrow":"",delta:0,onGoBack:X,fixed:!0,class:"custom-navbar"},null,8,["title"]),i($,{class:"filter-section"},{default:u(()=>[i($,{class:"filter-bar"},{default:u(()=>[i($,{class:"date-picker",onClick:a[0]||(a[0]=e=>D.value=!0)},{default:u(()=>[i(t,{class:"date-text"},{default:u(()=>[v(f(L.value),1)]),_:1}),i(j,{name:"caret-down-small",size:"32rpx",color:"#64748B"})]),_:1}),i($,{class:"stat-info"},{default:u(()=>[i(t,{class:"label"},{default:u(()=>[v(f(z.value&&G.value?"月贡献合计：":"总贡献合计："),1)]),_:1}),i(t,{class:"value"},{default:u(()=>[v("¥"+f(W.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),i(h,{class:"list-scroll","scroll-y":"",onScrolltolower:q},{default:u(()=>[U.value.length>0?(c(),s($,{key:0,class:"record-list"},{default:u(()=>[(c(!0),m(_,null,b(U.value,(e,a)=>(c(),s($,{class:"record-item animate-fade-in",key:a,style:y({animationDelay:.05*a+"s"})},{default:u(()=>[i($,{class:"record-left"},{default:u(()=>[i($,{class:"record-info"},{default:u(()=>[i($,{class:"title-row"},{default:u(()=>[i(t,{class:"record-title"},{default:u(()=>[v(f(e.title),1)]),_:2},1024),i(t,{class:x(["scene-tag","online"===e.scene?"online":"offline"])},{default:u(()=>[v(f("online"===e.scene?"线上":"线下"),1)]),_:2},1032,["class"])]),_:2},1024),e.status?(c(),s(t,{key:0,class:"record-status"},{default:u(()=>[v(f(e.status),1)]),_:2},1024)):k("",!0),i(t,{class:"record-date"},{default:u(()=>[v(f(e.date),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),i($,{class:"record-right"},{default:u(()=>[i(t,{class:x(["record-amount","expense"===e.type?"expense":"contribution"])},{default:u(()=>[v(f("expense"===e.type?"-":"+")+f(e.amount)+"元 ",1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["style"]))),128)),R.value?(c(),s($,{key:0,class:"load-more"},{default:u(()=>[i(t,null,{default:u(()=>[v("正在加载更多...")]),_:1})]),_:1})):(c(),s($,{key:1,class:"no-more"},{default:u(()=>[i(t,null,{default:u(()=>[v("没有更多记录了")]),_:1})]),_:1}))]),_:1})):(c(),s($,{key:1,class:"empty-state"},{default:u(()=>[i(j,{name:"info-circle",size:"120rpx",color:"#CBD5E1"}),i(t,{class:"empty-text"},{default:u(()=>[v(f(z.value&&G.value?"该月份暂无记录":"暂无相关记录"),1)]),_:1})]),_:1}))]),_:1}),i(E,{visible:D.value,"onUpdate:visible":a[1]||(a[1]=e=>D.value=e),value:[z.value,G.value],title:"选择日期","cancel-btn":"取消","confirm-btn":"确定",onConfirm:Y,onCancel:a[2]||(a[2]=e=>D.value=!1)},{default:u(()=>[i(B,{options:H.value},null,8,["options"]),i(B,{options:I.value},null,8,["options"])]),_:1},8,["visible","value"])]),_:1})}}}),[["__scopeId","data-v-bb8f8a20"]]);export{B as default};
