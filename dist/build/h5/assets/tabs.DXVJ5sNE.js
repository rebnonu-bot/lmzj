import{j as t,b as e,w as s,i as a,m as i,t as n,v as l,R as o,s as r,x as c,k as d,e as h,f as u,B as f,n as p,F as m,p as b}from"./index-PUK5Iwtz.js";import{u as y,p as x,t as g,a as v,d as _,n as S,e as P,_ as I,f as T,c as k,h as C}from"./icon.CJOHyHK1.js";import{R as $}from"./parent-map.DLFD9qfo.js";import{C as w,P as z}from"./relation.DOrZf5Wr.js";import{_ as L}from"./badge.Df-Vuzaj.js";const D={badgeProps:{type:Object,default:()=>({})},disabled:Boolean,icon:{type:[String,Object]},label:{type:String,default:""},lazy:Boolean,panel:{type:String},value:{type:[String,Number]}},A=`${x}-tab-panel`;const B=v(y({name:A,options:{styleIsolation:"shared",virtualHost:!0},externalClasses:[`${x}-class`],mixins:[w($.TabPanel)],props:{...D},data:()=>({prefix:x,classPrefix:A,active:!1,hide:!0,id:"",hasActivated:!1,tools:g}),watch:{label:"update",badgeProps:{handler(){this.update()},deep:!0},disabled:"update",icon:"update",panel:"update",value:"update",lazy:"update"},methods:{setParent(t){this[$.TabPanel]=t,t.children.includes(this)||t.children.push(this),t.innerAfterLinked(this)},setId(t){this.id=t},getComputedName(){return null!=this.value?`${this.value}`:`${this.dataIndex}`},update(){var t;null==(t=this[$.TabPanel])||t.updateTabs()},render(t,e){this.initialized=this.initialized||t,t&&!this.hasActivated&&(this.hasActivated=!0),this.active=t,this.hide=!e.animation&&!t}}}),[["render",function(d,h,u,f,p,m){const b=a;return!d.lazy||d.hasActivated?(t(),e(b,{key:0,id:d.id,class:c(d.tClass+" "+d.classPrefix+" "+(d.active?d.classPrefix+"--active":d.classPrefix+"--inactive")),style:r(d.tools._style([d.customStyle,d.hide?"display: none":""])),"aria-role":"tabpanel"},{default:s(()=>[d.panel?(t(),e(b,{key:0},{default:s(()=>[i(n(d.panel),1)]),_:1})):l("",!0),o(d.$slots,"default",{},void 0,!0),o(d.$slots,"panel",{},void 0,!0)]),_:3},8,["id","class","style"])):l("",!0)}],["__scopeId","data-v-48961358"]]),M={container:{type:Function},disabled:Boolean,offsetTop:{type:[String,Number],default:0},zIndex:{type:Number,default:99},onScroll:{type:Function,default:()=>({})}};const N=/scroll|auto|overlay/i,E=(new class{constructor(){this.listeners=new Map,this.emitted=new Map,this.onceListeners=new Map}on(t,e){const s=this.listeners.get(t)||[];s.push(e),this.listeners.set(t,s),this.emitted.has(t)&&e(...this.emitted.get(t))}once(t,e){if(this.emitted.has(t))return void e(...this.emitted.get(t));const s=(...a)=>{e(...a),this.off(t,s)},a=this.onceListeners.get(t)||new Map;a.set(e,s),this.onceListeners.set(t,a),this.on(t,s)}emit(t,...e){this.emitted.set(t,e);[...this.listeners.get(t)||[]].forEach(t=>t(...e))}off(t,e){if(e){const s=this.onceListeners.get(t);if(s&&s.has(e)){const a=s.get(e);return this._removeListener(t,a),void s.delete(e)}this._removeListener(t,e)}else this.listeners.delete(t),this.onceListeners.delete(t),this.emitted.delete(t)}_removeListener(t,e){const s=this.listeners.get(t);if(!s)return;const a=s.indexOf(e);a>-1&&(s.splice(a,1),0===s.length&&this.listeners.delete(t))}},function(t){const e=_();if(!e)return;const{pageScroller:s}=e;null==s||s.forEach(e=>{"function"==typeof e&&e(t)})});const F=`${x}-sticky`,X=`.${F}`;const O=v(y({name:F,options:{styleIsolation:"shared"},externalClasses:[`${x}-class`,`${x}-class-content`],mixins:[((t="onScroll")=>({mounted(){this._scroller=function(t,e){void 0===e&&(e=window);let s=t;for(;s&&"HTML"!==s.tagName&&"BODY"!==s.tagName&&1===s.nodeType&&s!==e;){const{overflowY:t}=window.getComputedStyle(s);if(N.test(t))return s;s=s.parentNode}return e}(this.$el),this._scroller&&this._scroller.addEventListener("scroll",this._bindScroller);const t=_();t&&(Array.isArray(t.pageScroller)?t.pageScroller.push(this._bindScroller):t.pageScroller="function"==typeof t.onPageScroll?[t.onPageScroll.bind(t),this._bindScroller]:[this._bindScroller],t.onPageScroll=E)},beforeUnMount(){var t;this._scroller&&this._scroller.removeEventListener("scroll",this._bindScroller);const e=_();e&&(e.pageScroller=(null==(t=e.pageScroller)?void 0:t.filter(t=>t!==this._bindScroller))||[])},methods:{_bindScroller(e){var s;let a;return a=null==(s=this[t])?void 0:s.call(this,e.target),a}}}))()],props:{...M},data:()=>({prefix:x,classPrefix:F,containerStyle:"",contentStyle:"",tools:g}),watch:{offsetTop:"onScroll",disabled:"onScroll",container:"onScroll"},mounted(){this.onScroll()},methods:{onScroll(t){const{scrollTop:e}=t||{},{container:s,offsetTop:a,disabled:i}=this;i?this.setDataAfterDiff({isFixed:!1,transform:0}):(this.scrollTop=e||this.scrollTop,"function"!=typeof s?P(this,X).then(t=>{t&&(a>=t.top?(this.setDataAfterDiff({isFixed:!0,height:t.height}),this.transform=0):this.setDataAfterDiff({isFixed:!1}))}):Promise.all([P(this,X),this.getContainerRect()]).then(([t,e])=>{t&&e&&(a+t.height>e.height+e.top?this.setDataAfterDiff({isFixed:!1,transform:e.height-t.height}):a>=t.top?this.setDataAfterDiff({isFixed:!0,height:t.height,transform:0}):this.setDataAfterDiff({isFixed:!1,transform:0}))}))},setDataAfterDiff(t){const{offsetTop:e}=this,{containerStyle:s,contentStyle:a}=this,{isFixed:i,height:n,transform:l}=t;S().then(()=>{let t="",o="";if(i&&(t+=`height:${n}px;`,o+=`position:fixed;top:${e}px;left:0;right:0;`),l){const t=`translate3d(0, ${l}px, 0)`;o+=`-webkit-transform:${t};transform:${t};`}s===t&&a===o||(this.containerStyle=t,this.contentStyle=o),this.$emit("scroll",{scrollTop:this.scrollTop,isFixed:i})})},getContainerRect(){const t=this.container();return new Promise(e=>t.boundingClientRect(e).exec())}}}),[["render",function(i,n,l,h,u,f){const p=a;return t(),e(p,{class:c(i.classPrefix+" "+i.tClass),style:r(i.tools._style(["z-index:"+i.zIndex,i.containerStyle,i.customStyle]))},{default:s(()=>[d(p,{class:c(i.classPrefix+"__content "+i.tClassContent),style:r(i.tools._style(["z-index:"+i.zIndex,i.contentStyle]))},{default:s(()=>[o(i.$slots,"default",{},void 0,!0)]),_:3},8,["class","style"])]),_:3},8,["class","style"])}],["__scopeId","data-v-5079de02"]]),j={animation:{type:Object},bottomLineMode:{type:String,default:"fixed",validator:t=>!t||["fixed","auto","full"].includes(t)},showBottomLine:{type:Boolean,default:!0},spaceEvenly:{type:Boolean,default:!0},split:{type:Boolean,default:!0},sticky:Boolean,stickyProps:{type:Object},swipeable:{type:Boolean,default:!0},theme:{type:String,default:"line",validator:t=>!t||["line","tag","card"].includes(t)},value:{type:[String,Number]},defaultValue:{type:[String,Number]},onChange:{type:Function,default:()=>({})},onClick:{type:Function,default:()=>({})},onScroll:{type:Function,default:()=>({})}},Y={data:()=>({}),methods:{resetTouchStatus(){this.direction="",this.deltaX=0,this.deltaY=0,this.offsetX=0,this.offsetY=0},touchStart(t){this.resetTouchStatus();const[e]=t.touches;this.startX=e.clientX,this.startY=e.clientY},touchMove(t){const[e]=t.touches;this.deltaX=e.clientX-this.startX,this.deltaY=e.clientY-this.startY,this.offsetX=Math.abs(this.deltaX),this.offsetY=Math.abs(this.deltaY),this.direction=((t,e)=>t>e&&t>10?"horizontal":e>t&&e>10?"vertical":"")(this.offsetX,this.offsetY)}}};const W=`${x}-tabs`,R=C("tabs");const V=v(y({name:W,options:{styleIsolation:"shared"},controlledProps:[{key:"value",event:"change"}],externalClasses:[`${x}-class`,`${x}-class-item`,`${x}-class-active`,`${x}-class-track`,`${x}-class-content`],mixins:[Y,z($.TabPanel)],components:{TSticky:O,TBadge:L,TIcon:I},props:{...j},emits:["change","scroll","error","click"],watch:{value:{handler(t){this.dataValue=t},immediate:!0},dataValue(t){t!==this.getCurrentName()&&this.setCurrentIndexByName(t)}},created(){this.children=this.children||[]},mounted(){S().then(()=>{this.setTrack()}),P(this,`.${W}`).then(t=>{this.containerWidth=t.width}),this.tabID=R()},data(){return{prefix:x,classPrefix:W,tabs:[],currentLabels:[],currentIndex:-1,trackOption:{lineWidth:0,distance:0,isInit:!0},offset:0,scrollLeft:0,tabID:"",placement:"top",tools:g,dataValue:k(this.value,this.defaultValue)}},methods:{trackStyle:function(t){return t.distance||t.lineWidth?g._style({"-webkit-transform":`translateX(${t.distance}px)`,transform:`translateX(${t.distance}px)`,"transition-duration":t.isInit?"0":"0.3s",width:`${t.lineWidth}px`,opacity:1}):""},animate:function(t){return t.duration?g._style({"transition-duration":`${t.duration}s`,transform:`translate3d( ${-100*t.currentIndex}%,0, 0)`}):""},innerAfterLinked(t){this.initChildId(),t.dataIndex=this.children.length-1,this.updateTabs()},innerAfterUnlinked(t){this.children=this.children.filter(e=>e.index!==t.dataIndex),this.updateTabs(()=>this.setTrack()),this.initChildId()},initChildId(){this.children.forEach((t,e)=>{t.setId(`${this.tabID}_panel_${e}`)})},onScroll(t={}){const{scrollLeft:e}=t.detail||{};this.scrollLeft=e},updateTabs(t){const{children:e}=this,s=e.map(t=>{const{label:e,badgeProps:s,disabled:a,icon:i,panel:n,value:l,lazy:o}=t;return{label:e,badgeProps:s,disabled:a,icon:i,panel:n,value:l,lazy:o}});s.forEach(t=>{"string"==typeof t.icon&&(t.icon={name:t.icon})}),this.tabs=s,"function"==typeof t&&setTimeout(t,33),this.setCurrentIndexByName(this.dataValue)},setCurrentIndexByName(t){const{children:e}=this,s=e.findIndex(e=>e.getComputedName()===`${t}`);s>-1&&this.setCurrentIndex(s)},setCurrentIndex(t){if(t<=-1||t>=this.children.length)return;const e=[];this.children.forEach((s,a)=>{const i=t===a;i===s.active&&s.initialized||s.render(i,this),e.push(s.label)});const{currentIndex:s,currentLabels:a}=this;s===t&&a.join("")===e.join("")||(this.currentIndex=t,this.currentLabels=e,setTimeout(()=>{this.setTrack()},33))},getCurrentName(){if(this.children){const t=this.children[this.currentIndex];if(t)return t.getComputedName()}},calcScrollOffset:(t,e,s,a)=>a+e-.5*t+s/2,getTabHeight(){return P(this,`.${W}`)},getTrackSize(){const{bottomLineMode:t}=this,e={fixed:`.${x}-tabs__track`,auto:`.${x}-tabs__item--active .${x}-tabs__item-inner`,full:`.${x}-tabs__item--active`};return new Promise((s,a)=>{this.trackWidth?s(this.trackWidth):P(this,e[t]||e.fixed).then(t=>{t&&s(t.width)}).catch(a)})},async setTrack(){const{children:t}=this;if(!t)return;const{currentIndex:e}=this;if(!(e<=-1))try{const t=await P(this,`.${x}-tabs__item`,!0),s=t[e];if(!s)return;let a=0,i=0,n=0;if(t.forEach(t=>{a<e&&(i+=t.width,a+=1),n+=t.width}),this.containerWidth){const t=this.calcScrollOffset(this.containerWidth,s.left,s.width,this.scrollLeft),e=n-this.containerWidth;this.offset=Math.min(Math.max(t,0),e)}else this._hasObserved||(this._hasObserved=!0,T(this,`.${W}`).then(()=>this.setTrack()));const l=await this.getTrackSize();"line"===this.theme&&(i+=(s.width-l)/2);const o=void 0===this.previousIndex;(o||this.previousIndex!==e||this.lastDistance!==i)&&(this.previousIndex=e,this.trackOption={lineWidth:l,distance:i,isInit:o},this.lastDistance=i)}catch(s){this.$emit("error",s)}},onTabTap(t){const{index:e}=t.currentTarget.dataset;this.changeIndex(e)},onTouchStart(t){this.swipeable&&this.touchStart(t)},onTouchMove(t){this.swipeable&&this.touchMove(t)},onTouchEnd(){if(!this.swipeable)return;const{direction:t,deltaX:e,offsetX:s}=this;if("horizontal"===t&&s>=50){const t=this.getAvailableTabIndex(e);-1!==t&&this.changeIndex(t)}},onTouchScroll(t){this._trigger("scroll",t)},changeIndex(t){const e=this.tabs[t],{value:s,label:a}=e;(null==e?void 0:e.disabled)||t===this.currentIndex||this._trigger("change",{value:s,label:a}),this._trigger("click",{value:s,label:a})},getAvailableTabIndex(t){const e=t>0?-1:1,{currentIndex:s,tabs:a}=this,i=a.length;for(let n=e;s+e>=0&&s+e<i;n+=e){const t=s+n;if(!(t>=0&&t<i&&a[t]))return s;if(!a[t].disabled)return t}return-1},getBadgeCustomStyle(t,e){return t.disabled?"--td-badge-content-text-color: var(--td-tab-item-disabled-color, var(--td-text-color-disabled, var(--td-font-gray-4, rgba(0, 0, 0, .26))))":this.currentIndex===e?"--td-badge-content-text-color: var(--td-tab-item-active-color, var(--td-brand-color, var(--td-primary-color-7, #0052d9)));":""},getIconCustomStyle:t=>g._style([{fontSize:"var(--td-tab-icon-size, 18px)",marginRight:"calc(var(--td-spacer, 8px) / 4)"},t.icon.style||""])}}),[["render",function(y,x,g,v,_,S){const P=h(u("t-icon"),I),T=h(u("t-badge"),L),k=a,C=f,$=h(u("t-sticky"),O);return t(),e(k,{style:r(y.tools._style([y.customStyle])),class:c(y.tools.cls(y.classPrefix,[y.placement])+" "+y.tClass)},{default:s(()=>[d($,{"t-class":y.tools.cls(y.classPrefix+"__sticky",[y.placement]),disabled:!y.sticky,"z-index":y.stickyProps&&y.stickyProps.zIndex||1,"offset-top":y.stickyProps&&y.stickyProps.offsetTop||0,container:y.stickyProps&&y.stickyProps.container,onScroll:y.onTouchScroll},{default:s(()=>[d(k,{class:c(y.tools.cls(y.classPrefix+"__wrapper",[y.theme]))},{default:s(()=>[d(C,{class:c(y.tools.cls(y.classPrefix+"__scroll",[y.placement,["split",y.split]])),enhanced:"","enable-flex":"","scroll-left":y.offset,"scroll-x":!0,"scroll-anchoring":"","scroll-with-animation":"","enable-passive":"","show-scrollbar":!1,type:"list",onScroll:y.onScroll},{default:s(()=>[d(k,{class:c(y.tools.cls(y.classPrefix+"__nav",[y.placement,["evenly",y.spaceEvenly]])),"aria-role":"tablist"},{default:s(()=>[(t(!0),p(m,null,b(y.tabs,(a,o)=>(t(),e(k,{key:o,"data-index":o,class:c(y.tools.cls(y.classPrefix+"__item",[y.theme,["evenly",y.spaceEvenly],y.placement,["disabled",a.disabled],["active",y.currentIndex===o]])+" "+(y.currentIndex===o?y.tClassActive:"")+" "+y.tClassItem),"aria-role":"tab","aria-controls":y.tabID+"_panel_"+o,"aria-selected":y.currentIndex===o,"aria-disabled":a.disabled,"aria-label":y.ariaLabel||(a.badgeProps.dot||a.badgeProps.count?a.label+y.tools.getBadgeAriaLabel({...a.badgeProps}):""),onClick:y.onTabTap},{default:s(()=>[d(k,{class:c(y.tools.cls(y.classPrefix+"__item-inner",[y.theme,["active",y.currentIndex===o]])),"aria-hidden":a.badgeProps.dot||a.badgeProps.count},{default:s(()=>[a.icon?(t(),e(P,{key:0,"t-class":y.classPrefix+"__icon","custom-style":y.getIconCustomStyle(a),prefix:a.icon.prefix,name:a.icon.name,size:a.icon.size,color:a.icon.color,"aria-hidden":!!a.icon.ariaHidden,"aria-label":a.icon.ariaLabel,"aria-role":a.icon.ariaRole,onClick:t=>a.icon.click||""},null,8,["t-class","custom-style","prefix","name","size","color","aria-hidden","aria-label","aria-role","onClick"])):l("",!0),a.badgeProps?(t(),e(T,{key:1,color:a.badgeProps.color||"",content:a.label,count:a.badgeProps.count||0,dot:a.badgeProps.dot||!1,"max-count":a.badgeProps.maxCount||99,offset:a.badgeProps.offset||[],shape:a.badgeProps.shape||"circle","show-zero":a.badgeProps.showZero||!1,size:a.badgeProps.size||"medium","t-class":y.tools.cls(y.classPrefix+"__badge",[["disabled",a.disabled],["active",y.currentIndex===o]]),"custom-style":y.getBadgeCustomStyle(a,o),"t-class-content":a.badgeProps.tClassContent,"t-class-count":a.badgeProps.tClassCount},null,8,["color","content","count","dot","max-count","offset","shape","show-zero","size","t-class","custom-style","t-class-content","t-class-count"])):(t(),p(m,{key:2},[i(n(a.label),1)],64))]),_:2},1032,["class","aria-hidden"]),"card"==y.theme&&y.currentIndex-1==o?(t(),e(k,{key:0,class:c(y.classPrefix+"__item-prefix")},null,8,["class"])):l("",!0),"card"==y.theme&&y.currentIndex+1==o?(t(),e(k,{key:1,class:c(y.classPrefix+"__item-suffix")},null,8,["class"])):l("",!0)]),_:2},1032,["data-index","class","aria-controls","aria-selected","aria-disabled","aria-label","onClick"]))),128)),"line"==y.theme&&y.showBottomLine?(t(),e(k,{key:0,class:c(y.tools.cls(y.classPrefix+"__track",[y.placement])+" "+y.tClassTrack),style:r(y.trackStyle(y.trackOption))},null,8,["class","style"])):l("",!0)]),_:1},8,["class"])]),_:1},8,["class","scroll-left","onScroll"])]),_:1},8,["class"])]),_:1},8,["t-class","disabled","z-index","offset-top","container","onScroll"]),o(y.$slots,"middle",{},void 0,!0),d(k,{class:c(y.tools.cls(y.classPrefix+"__content",[["animated",y.animation]])),onTouchstart:y.onTouchStart,onTouchmove:y.onTouchMove,onTouchend:y.onTouchEnd,onTouchcancel:y.onTouchEnd},{default:s(()=>[d(k,{class:c(y.classPrefix+"__content-inner "+y.tClassContent),style:r(y.animate({duration:y.animation&&y.animation.duration,currentIndex:y.currentIndex}))},{default:s(()=>[o(y.$slots,"default",{},void 0,!0)]),_:3},8,["class","style"])]),_:3},8,["class","onTouchstart","onTouchmove","onTouchend","onTouchcancel"])]),_:3},8,["style","class"])}],["__scopeId","data-v-bd7759f1"]]);export{B as _,V as a};
